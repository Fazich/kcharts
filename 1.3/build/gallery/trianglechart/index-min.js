/*! kcharts - v1.3 - 2013-12-24 11:57:25 AM
* Copyright (c) 2013 数据可视化小组; Licensed  */
KISSY.add("gallery/kcharts/1.3/gallery/trianglechart/theme",function(){var t={"ks-chart-default":{title:{content:"",css:{"text-align":"center","font-size":"16px","font-weight":"bold",color:"#666"},isShow:!0},subTitle:{content:"",css:{"text-align":"center","font-size":"12px",color:"#666"},isShow:!0},xGrids:{css:{color:"#eee"}},yGrids:{css:{color:"#eee"}},yAxis:{css:{color:"#ccc"}},xAxis:{css:{color:"#ccc"}},xLabels:{css:{color:"#666","font-size":"12px"}},yLabels:{css:{color:"#666","font-size":"12px"}},tip:{css:{border:"1px solid {COLOR}"}}},"ks-chart-analytiks":{title:{content:"",css:{"text-align":"center","font-size":"16px","font-weight":"bold",color:"#666"},isShow:!0},subTitle:{content:"",css:{"text-align":"center","font-size":"12px",color:"#666"},isShow:!0},xGrids:{css:{color:"#eee"}},yGrids:{css:{color:"#eee"}},yAxis:{css:{color:"#ccc"}},xAxis:{css:{color:"#ccc"}},xLabels:{css:{color:"#666","font-size":"12px"}},yLabels:{css:{color:"#666","font-size":"12px"}},tip:{css:{border:"1px solid {COLOR}"}}},"ks-chart-rainbow":{title:{content:"",css:{"text-align":"center","font-size":"16px","font-weight":"bold",color:"#666"},isShow:!0},subTitle:{content:"",css:{"text-align":"center","font-size":"12px",color:"#666"},isShow:!0},xGrids:{css:{color:"#eee"}},yGrids:{css:{color:"#eee"}},yAxis:{css:{color:"#ccc"}},xAxis:{css:{color:"#ccc"}},xLabels:{css:{color:"#666","font-size":"12px"}},yLabels:{css:{color:"#666","font-size":"12px"}},tip:{css:{border:"1px solid {COLOR}"}}}};return t}),KISSY.add("gallery/kcharts/1.3/gallery/trianglechart/index",function(t,e,l,i,r,n,s,a,o){var c,h=t.all,x=(t.Event,"ks-chart-"),f=x+"default",y="{COLOR}",u=function(t){this.init(t)};return t.extend(u,l,{init:function(e){var r,s,a=this;if(a.chartType="trianglechart",l.prototype.init.call(a,e),a._$ctnNode[0]){var h={themeCls:f,autoRender:!0,colors:[],title:{content:"",css:{"text-align":"center","font-size":"16px"},isShow:!0},subTitle:{content:"",css:{"text-align":"center","font-size":"12px"},isShow:!0},xLabels:{isShow:!0,css:{color:"#666","font-size":"12px","white-space":"nowrap",position:"absolute"}},yLabels:{isShow:!0,css:{color:"#666","font-size":"12px","white-space":"nowrap",position:"absolute"}},xAxis:{isShow:!0,css:{color:"#eee",zIndex:10},min:0},yAxis:{isShow:!0,css:{zIndex:10},num:5,min:0},xGrids:{isShow:!0,css:{}},yGrids:{isShow:!0,css:{}},areas:{isShow:!0,css:{}},triangles:{isShow:!0,css:{background:y,border:"1px solid #fff"}},legend:{isShow:!1},tip:{isShow:!0,template:"",css:{},anim:{easing:"easeOut",duration:.3},offset:{x:0,y:0},boundryDetect:!0,alignX:"right",alignY:"bottom"}};a._triangles={},a._finished=[],f=a._cfg.themeCls||h.themeCls,a._cfg=t.mix(t.mix(h,i[f],o,o,!0),a._cfg,o,o,!0),a.color=c=new n({themeCls:f}),s=a._points[0],r=Math.round(s&&s[0]&&s[1]&&s[1].x-s[0].x||a.getInnerContainer().width),r&&a.set("area-width",r),a._cfg.colors.length>0&&c.removeAllColors();for(var x in a._cfg.colors)c.setColor(a._cfg.colors[x]);a._cfg.autoRender&&a.render(!0)}},drawTitle:function(){var e=this,l=e.htmlPaper,i=f+"-title",r=e._cfg,n=e._innerContainer,s=.6*n.y;!e._title&&r.title.isShow&&""!=r.title.content&&(e._title=l.rect(0,0,e._$ctnNode.width(),s).addClass(i).css(t.mix({"line-height":s+"px"},r.title.css))),e._title&&""!=r.title.content&&e._title.html(r.title.content)},drawSubTitle:function(){var e=this,l=e.htmlPaper,i=f+"-subtitle",r=e._cfg,n=e._innerContainer,s=.4*n.y;!e._subTitle&&r.subTitle.isShow&&""!=r.subTitle.content&&(e._subTitle=l.rect(0,.6*n.y,e._$ctnNode.width(),s).addClass(i).css(t.mix({"line-height":s+"px"},r.subTitle.css))),e._subTitle&&""!=r.subTitle.content&&e._subTitle.html(r.subTitle.content)},getTrianglePos:function(){var t,e=this,l=e._cfg.triangles.ratio||1,i=e.get("area-width")*l,r=e._innerContainer;e._trianglePos={};for(var n in e._points[0])t=e._points[0][n],e._trianglePos[n]=[t.x,t.y,t.x-i/2,r.bl.y,t.x/1+i/2,r.bl.y]},drawTriangles:function(){var t,e=this,l=(e._cfg,e.paper);e._innerContainer;for(var i in e._trianglePos)t=e._trianglePos[i],l.path(["M",t[0]+",",t[1],"L",t[2]+",",t[3]+",",t[4]+",",t[5]+"Z"].join("")).attr({fill:e.color.getColor(i).DEFAULT})},drawAxisX:function(){var t=this,e=t._innerContainer,l=e.bl,i=e.width,r=t.htmlPaper,n=t._cfg.themeCls+"-axisx";return t._axisX=r.lineX(l.x,l.y,i).addClass(n).css(t._cfg.xAxis.css||{}),t._axisX},drawAxisY:function(){var t=this,e=t._innerContainer,l=e.tl,i=e.height,r=t.htmlPaper,n=t._cfg.themeCls+"-axisy";return t._axisY=r.lineY(l.x,l.y,i).addClass(n).css(t._cfg.yAxis.css||{}),t._axisY},drawLabelsX:function(){var t=this,e=t._cfg,l="y"==e.zoomType?!0:!1;if(l)for(var i in t._pointsX)t._labelX[i]={0:t.drawLabelX(i,t._pointsX[i].number)};else for(var i in t._cfg.xAxis.text)t._labelX[i]={0:t.drawLabelX(i,t._cfg.xAxis.text[i])}},drawLabelsY:function(){var t=this,e=t._cfg,l="x"==e.zoomType?!1:!0;if(l)for(var i in t._cfg.yAxis.text)t._labelY[i]={0:t.drawLabelY(i,t._cfg.yAxis.text[i])};else for(var i in t._pointsY)t._labelY[i]={0:t.drawLabelY(i,t._pointsY[i].number),num:t._pointsY[i].number}},drawLabelX:function(l,i){var r,n=this,s=n.htmlPaper,a=n._pointsX,c=n._innerContainer,h=a.length||0,x=n._cfg.themeCls+"-xlabels",f="{{data}}",y="";return h>l?(f=n._cfg.xLabels.template||f,y=t.isFunction(f)?f(l,i):e(f).render({data:i}),r=a[l],r[0]=s.text(r.x,c.bl.y,"<span class="+x+">"+y+"</span>","center").children().css(n._cfg.xLabels.css),r[0]):o},drawLabelY:function(l,i){var r=this,n=r.htmlPaper,s=r._innerContainer,a=r._cfg.themeCls+"-ylabels",o="{{data}}",c="";return o=r._cfg.yLabels.template||o,c=t.isFunction(o)?o(l,i):e(o).render({data:i}),c&&n.text(s.tl.x,r._pointsY[l].y,"<span class="+a+">"+c+"</span>","right","middle").children().css(r._cfg.yLabels.css)},renderLegend:function(){var e=this,l=e._cfg.legend,i=l.container&&h(l.container)[0]?h(l.container):e._$ctnNode,r=e._innerContainer,n=e.color._colors,s=n.length,o=e._cfg,c=e._cfg.series,x=t.map(c,function(t,e){e%=s;var l={},i=n[e];return l.text=t.text,l.DEFAULT=i.DEFAULT,l.HOVER=i.HOVER,l}),f=t.merge({interval:20,iconright:5,showicon:!0},o.legend.globalConfig);return e.legend=new a({container:i,bbox:{width:r.width,height:r.height,left:r.x,top:r.y},align:o.legend.align||"bc",offset:o.legend.offset||(/t/g.test(o.legend.align)?[0,0]:[0,20]),globalConfig:f,config:x}),e.legend.on("click",function(t){var e=t.index,l=(t.text,t.icon,t.el);1!=l.hide?(this.hideBar(e),l.hide=1,l.disable()):(this.showBar(e),l.hide=0,l.enable())},this),e.legend},render:function(e){var l=this,i=l._cfg;l._innerContainer,i.themeCls,e&&l._$ctnNode.html(""),l.paper=r(l._$ctnNode[0],i.width,i.height),l._clonePoints=l._points,l.getTrianglePos(),l.htmlPaper=new s(l._$ctnNode),l.drawTitle(),l.drawSubTitle(),i.xAxis.isShow&&l.drawAxisX(),i.yAxis.isShow&&l.drawAxisY(),i.xLabels.isShow&&l.drawLabelsX(),i.yLabels.isShow&&l.drawLabelsY(),l.getTrianglePos(),l.drawTriangles(function(){t.log("finished"),l.afterRender()}),l.bindEvt(),t.log(l)},renderLegend:function(){var e=this,l=e._cfg.legend,i=l.container&&h(l.container)[0]?h(l.container):e._$ctnNode,r=e._stocks,n=e._innerContainer,s=e.color._colors,o=s.length,c=e._cfg,x=e._cfg.series,f=t.map(x,function(t,e){e%=o;var l={},i=s[e];l.text=t.text,l.DEFAULT=i.DEFAULT,l.HOVER=i.HOVER;var n=r[e].type;return l.icontype="line"+n,l.iconsize=[1,1],l}),y=t.merge({interval:20,iconright:5,showicon:!0},c.legend.globalConfig);return e.legend=new a({container:i,paper:e.paper,bbox:{width:n.width,height:n.height,left:n.x,top:n.y},align:c.legend.align||"bc",offset:c.legend.offset||[0,30],globalConfig:y,config:f}),e.legend.on("click",function(t){var e=t.index,l=(t.text,t.icon,t.el);1!=l.hide?(this.hideLine(e),l.hide=1,l.disable()):(this.showLine(e),l.hide=0,l.enable())},this),e.legend},bindEvt:function(){var t=this;t._cfg},paperLeave:function(){var t=this;t.fire("paperLeave",t)},barChange:function(e,l){var i=this,r=i._bars[e],n=t.mix({target:r.bars[l],currentTarget:r.bars[l],barGroup:Math.round(e),barIndex:Math.round(l)},i._points[e][l]);i.fire("barChange",n)},animateGridsAndLabels:function(){var t=this;for(var e in t._labelY)t._labelY[e]&&t._labelY[e][0]&&t._labelY[e][0].remove(),t._gridsY[e]&&t._gridsY[e][0]&&t._gridsY[e][0].remove();t.drawGridsY(),t.drawLabelsY()},processAttr:function(e,l){var i=t.clone(e);for(var r in i)i[r]&&"string"==typeof i[r]&&(i[r]=i[r].replace(y,l));return i},afterRender:function(){var t=this;t.fire("afterRender",t)},getRaphaelPaper:function(){return this.paper},getHtmlPaper:function(){return this.htmlPaper},clear:function(){return this.paper.clear()}}),u},{requires:["gallery/template/1.0/index","gallery/kcharts/1.3/basechart/index","./theme","gallery/kcharts/1.3/raphael/index","gallery/kcharts/1.3/tools/color/index","gallery/kcharts/1.3/tools/htmlpaper/index","gallery/kcharts/1.3/legend/index","gallery/kcharts/1.3/tools/touch/index","gallery/kcharts/1.3/tip/index"]});