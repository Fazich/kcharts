/*! kcharts - v1.3 - 2014-01-08 5:16:06 PM
* Copyright (c) 2014 数据可视化小组; Licensed  */
KISSY.add("gallery/kcharts/1.3/realtime/util",function(){function t(t,e){for(var l=Math.min.apply(Math,t),r=Math.max.apply(Math,t),i=r-l,n=[u,f,d,p,g],a=[],s=0;n.length>s;s++){var o=i/n[s];if(1>o)break;a.push(o-e)}var h,c=Math.min.apply(Math,a);h=c?a.indexOf(c):0;var x=["minute","hour","day","week","month"];return x[h]}function e(t){var e={minute:6e4,hour:36e5,day:864e5,week:6048e5,month:18144e6};return e[t]}function l(t,e){var l={"M+":t.getMonth()+1,"d+":t.getDate(),"h+":t.getHours(),"m+":t.getMinutes(),"s+":t.getSeconds(),"q+":Math.floor((t.getMonth()+3)/3),S:t.getMilliseconds()};/(y+)/.test(e)&&(e=e.replace(RegExp.$1,(t.getFullYear()+"").substr(4-RegExp.$1.length)));for(var r in l)RegExp("("+r+")").test(e)&&(e=e.replace(RegExp.$1,1==RegExp.$1.length?l[r]:("00"+l[r]).substr((""+l[r]).length)));return e}function r(t,e){return Math.round(t*e)/e}function i(t,e,l){l>1?l=1:0>l&&(l=0);var r=t+(e-t)*l;return Math.round(100*r)/100}function n(t,e){var l=[e[0]-t[0],e[1]-t[1]];if(0===l[0])return l[1]>0?90:0>l[1]?-90:0;var r=E*Math.atan(l[1]/l[0]);return 0>l[0]&&(r-=180),r}function a(t,e,l){l||(l={});var a,s,o,h,c="number"!=typeof l.scale?3:l.scale,x="number"!=typeof l.ratio?.5:l.ratio,y=1e6,u=n(t,e),f=Math.cos(u*M),d=Math.sin(u*M),p=i(t[0],e[0],x),g=i(t[1],e[1],x);return a=p+d*c,o=g-f*c,s=p-d*c,h=g+f*c,{x0:r(p,y),y0:r(g,y),x1:r(a,y),y1:r(o,y),x2:r(s,y),y2:r(h,y)}}function s(t,e){for(var l=t.name,r=!0,i=0,n=e.length;n>i;i++)if(e[i].name===l){var a=e[i].data;e[i].data=[].concat(a,t.data),r=!1;break}r&&e.push(t)}function o(t,e){var l=e&&t&&t[0];l&&l.setAttribute("shape-rendering","crispEdges")}function h(t){var e,l,r,i;r=i=0;for(var n=0,a=0,s=t.length;s>a;a++)t[a]&&"number"==typeof t[a].x&&(r+=t[a].x,i+=t[a].y,n++);return e=r/n,l=i/n,{x:e,y:l}}function c(t,e,l){return e.length>=t?e:c(t,l+e,l)}var x={},y=function(t){this.console&&console.log(t)},u=6e4,f=36e5,d=864e5,p=6048e5,g=18144e6;x.chooseUnit=t,x.unit2digts=e;var v=2.220446049250313e-16,m=1/Math.log(10),_=function(t,e,l,r,i,n){var a;return a=(v>r%n||v>n-r%n)&&0>=r&&i>=0?1:0,1-t/(e-1)-l+a},b=function(t,e,l){return 1-t/(e-1)-l+1},w=function(t,e,l,r){var i;return i=e-t,1-.5*(Math.pow(e-r,2)+Math.pow(t-l,2))/Math.pow(.1*i,2)},k=function(t,e,l){var r,i;return i=e-t,l>i?(r=(l-i)/2,1-.5*(Math.pow(r,2)+Math.pow(r,2))/Math.pow(.1*i,2)):1},C=function(t,e,l,r,i,n){var a,s;return a=(t-1)/(n-i),s=(e-1)/(Math.max(n,r)-Math.min(l,i)),2-Math.max(a/s,s/a)},S=function(t,e){return t>=e?2-(t-1)/(e-1):1},L=function(t,e,l,r,i,n){var a,s,o,h,c,x,y,u,f,d,p,g,L,A,T,M,E,B,I,P,z,N,F,R,D,$,O,Y,G,j,X,q,V;if(null==r&&(r=!1),null==i&&(i=[1,5,2,2.5,4,3]),null==n&&(n={simplicity:.2,coverage:.25,density:.5,legibility:.05}),R=function(t,e,l,r){return n.simplicity*t+n.coverage*e+n.density*l+n.legibility*r},s=0,a=0,o=0,h=-2,f=v,q=t>e?[e,t]:[t,e],I=q[0],E=q[1],f>e-t)return[I,E,l,-2];for(A=i.length,p=-1;Number.POSITIVE_INFINITY>p;){for(N=j=0,V=A-1;V>=0?V>=j:j>=V;N=V>=0?++j:--j)if(z=i[N],D=b(N,A,p),h>R(D,1,1,1))p=Number.POSITIVE_INFINITY;else for(g=2;Number.POSITIVE_INFINITY>g;){if(u=S(g,l),h>R(D,1,u,1))g=Number.POSITIVE_INFINITY;else for(y=(E-I)/(g+1)/p/z,G=Math.ceil(Math.log(y)*m);Number.POSITIVE_INFINITY>G;)if(O=p*z*Math.pow(10,G),x=k(I,E,O*(g-1)),h>R(D,x,u,1))G=Number.POSITIVE_INFINITY;else{if(P=Math.floor(E/O)*p-(g-1)*p,B=Math.ceil(I/O)*p,P>B);else for($=X=P;B>=P?B>=X:X>=B;$=B>=P?++X:--X)M=$*(O/p),T=M+O*(g-1),(!r||I>=M&&T>=E)&&(F=_(N,A,p,M,T,O),c=w(I,E,M,T),d=C(g,l,I,E,M,T),L=1,Y=R(F,c,d,L),Y>h&&(h=Y,s=M,a=T,o=O));G+=1}g+=1}p+=1}return[s,a,o,h]};x.getProperUnit=L;var A=function(t,e,l){var r=L(t,e,l),i=r[0],n=r[1],a=r[2];e>n&&(n+=a),i>t&&(i-=a);for(var s=(n-i)/a,o=[],h=i,c=1;s>=c;c++)o.push(h),h+=a;return o.push(h),o};x.axis=A;var T=function(l,r){var i=Math.max.apply(Math,l),n=t(l,r);n||y("ERR OCCURED!");var a,s,o=e(n),h=l.map(function(t){return t/o});a=Math.min.apply(Math,h),s=Math.max.apply(Math,h);var c=A(a,s,r),x=Math.min.apply(Math,c)*o,u=Math.max.apply(Math,c)*o;return i>u&&(u+=o),c=c.map(function(t){return+new Date(t*o)}),{dates:c,unit:o,min:x,max:u}};x.getlabel=T,x.formatDate=l,x.roundToFixed=r;var M=Math.PI/180,E=180/Math.PI;return x.verticalLine=a,x.combineSeries=s,x.fixSVGLineStyle=o,x.averagePoints=h,x.pad=c,x}),KISSY.add("gallery/kcharts/1.3/realtime/index",function(t,e,l,r,i,n,a,s,o){function h(t){for(var e=[],l=[],r=0;t.length>r;r++){var i=t[r],n=i.data;if(n)for(var a=0;n.length>a;a++){var s=n[a];"number"==typeof s[0]?e.push(s[0]):e.push(null),"number"==typeof s[1]?l.push(s[1]):l.push(null)}}return{dates:e,values:l}}function c(t,e,l,r){for(var i=[],n=e.range,a=l.range,s=0,o=t.length;o>s;s++){var h;if(t[s].hided)h=[];else{var c=t[s];h={data:[],name:c.name};for(var x=0,y=c.data.length;y>x;x++){var u=c.data[x],f=u[0],d=u[1],p=r(n,a,f,d);p&&h.data.push(p)}}i.push(h)}return i}function x(t,e){e||(e={}),e.n||(e.n=5);var l=Math.min.apply(Math,t),r=Math.max.apply(Math,t);e.range&&"number"==typeof e.range.min&&l>e.range.min&&(l=e.range.min),e.range&&"number"==typeof e.range.max&&e.range.max>r&&(r=e.range.max);var i=n.axis(l,r,e.n),a=Math.min.apply(Math,i),s=Math.max.apply(Math,i),o={min:a,max:s,range:i};return o}function y(t,e){e||(e={n:5});var l=n.getlabel(t,e.n),r=l.min,i=l.max,a={unit:l.unit,min:r,max:i,range:l.dates};return a}function u(t,e,l){var r=t,i=Math.floor((e-t)/l);r=t+i*l;for(var n=[],a=t;r>=a;a+=l)n.push(a);return{range:n,min:t,max:r,len:i}}function f(t){for(;t.length;){var e=t.pop();e&&e.remove&&e.remove()}}function d(t){for(var e,l=0,r=t.length;r>l;l++){var i=t[l],n=i.x,a=i.y;l?e.push("L",n,a):e=["M",n,a]}return e.join(",")}function p(t){var e,l,r,i,a=[];if(2>=t.length)for(var s=0,o=t.length;o>s;s++)l=t[s],r=l.x,i=l.y,r=n.roundToFixed(r,100),i=n.roundToFixed(i,100),s?a.push("L",r,i):a.push("M",r,i);else for(var s=0,o=t.length;o>s;s++)l=t[s],r=l.x,i=l.y,r=n.roundToFixed(r,100),i=n.roundToFixed(i,100),s?a.push(r,i):a.push("M",r,i,"R");return e=a.join(",")}function g(t,e){for(var l,r,i,n=[],a=[],s=0,o=t.length;o>s;s++)l=t[s],r=l.x,i=l.y,null===r?(n.push(a),a=[]):a.push(l);n.push(a);for(var h="",c=0,x=n.length;x>c;c++)h+=e(n[c]);return h}function v(t,e,l){for(var r,i,a=[],s=0,o=l.n;o>s;s++)r=s/(o-1),l.ratio=r,i=n.verticalLine(t,e,l),a.push(i);return a}function m(t,e,l){if(l||(l={}),2>arguments.length)return!1;for(var r,i,a,s,o,h=l.style||{},c=h.ruller||"-.",x=[],y=1,u=t.length;u>y;y++){if(r=t[y],"-."===c)i=r.x0,s=r.y0,l.xaxis?(a=r.x2,o=r.y2):(a=r.x1,o=r.y1);else if(".-"===c)l.xaxis?(i=r.x0,s=r.y0,a=r.x2,o=r.y2):(i=r.x0,s=r.y0,a=r.x1,o=r.y1);else{if("-.-"!==c)return!1;i=r.x1,s=r.y1,a=r.x2,o=r.y2}x.push("M",n.roundToFixed(i,10),n.roundToFixed(s,10),"L",n.roundToFixed(a,10),n.roundToFixed(o,10))}var f=x.join(","),d=l.path;if(d)d.animate({path:f},200);else{var p=B(h.style);d=e.path(f).attr(p)}return d}function _(t,e){var l,r,i=e.xmin,n=e.xmax,a=e.ymin,s=e.ymax,o=e.px,h=e.py,c=t[0],x=t[1],y=e.width,u=e.height;return null===c||null===x?(l=null,r=null):(l=(c-i)/(n-i)*y+o,r=u-(x-a)/(s-a)*u+h),[l,r]}function b(t,e){for(var l=[],r=0;t.length>r;r++){var i=[];l.push(i);var n=t[r],a=n.data;if(a)for(var s=0;a.length>s;s++){var o,h,c=a[s],x=_(c,e);o=x[0],h=x[1],i.push({x:o,y:h,rawx:c[0],rawy:c[1]})}}return l}function w(t,l){function n(){o.attr({stroke:c.DEFAULT,"stroke-width":2}),o.hover(function(){o.attr({stroke:c.HOVER,"stroke-width":3})},function(){o.attr({stroke:c.DEFAULT,"stroke-width":2})})}var a=new r.Defer,s=a.promise;l.context;var o,h,c,x=l.paper;h=x.set(),c=l.color;var y,u;if(u="arc"===l.lineType?g(t,p):g(t,d),l.$line)o=l.$line,o.animate({path:u},200),setTimeout(function(){a.resolve({$line:o,$points:h,color:c})},0);else{var f,v=e.getTotalLength(u);y=i.AnimateObject([{from:{per:0},to:{per:1},frame:function(t,l){var r=e.getSubpath(u,0,l*v);o?o.attr({path:r}):(o=x.path(r),n()),f=l},endframe:function(){1!==f&&o.attr({path:u}),a.resolve({$line:o,$points:h,color:c})}}],{easing:"easeNone",duration:1e3})}return l.pointConfig.isShow!==!1&&G(t,function(t){var e=x.circle(t.x,t.y,4);e.attr({stroke:"#fff",fill:c.DEFAULT,"stroke-width":2}),h.push(e)}),s}function k(t){var e=(t.$line,t.$points);e&&e.unhover(),e&&e.remove()}function C(t){if(t)for(var e=0,l=t.length;l>e;e++)k(t[e])}function S(t,e){var l=t.get("$lines");return l&&l[e]}function L(t){var e=/(\d+)?(day|week|month)/,l=t.match(e);if(!l)return!1;var r,i;r=l.length>1?parseInt(l[1])||1:1,i=l[2];var n,a=[];if("day"===i)a.push(0),n=24*r-1;else if("week"===i)n=7*r;else if("month"===i){var s=new Date;n=new Date(s.getFullYear(),s.getMonth()+1,0).getDate(),n*=r}for(var o=1;n>=o;o++)a.push(o);return a}function A(t){return 10>t?"0"+t:t}function T(t,e){if("day"===e)return A(t)+":00";if("week"===e){var l=["一","二","三","四","五","六","日"];return"星期"+l[t-1]}return"month"===e?n.formatDate(new Date,"yyyy-MM")+"-"+A(t,2):!1}function M(t,e){var l=L(e),r=l[0],i=l[l.length-1];return t>=r&&i>=t?!1:!0}function E(t){var e=t.currentTarget;if(t.offsetX)return{offsetX:t.offsetX,offsetY:t.offsetY};var l=a.offset(e);return{offsetX:t.offsetX||t.clientX-l.left,offsetY:t.offsetY||t.clientY-l.top}}function B(e){return t.merge({stroke:"#999","stroke-width":"1"},e)}function I(t,l,r,i){for(var a,s,o,h,c,x=i.paper,y=i.context,u=[],f=1,d=r.length;d>f;f++)i.vertical?(a=r[f].x0,s=r[f].y0,o=a,h=t,c="$yGrid"):(a=r[f].x0,s=r[f].y0,o=l,h=s,c="$xGrid"),u.push("M",a,s,"L",o,h);var p=y.get(c);return p?p.attr({path:u.join(",")}):(p=x.path(u.join(",")),y.set(c,p),p.attr(B()),n.fixSVGLineStyle(p,e.svg)),p}function P(t,e,l){l||(l="x");for(var r=[],i=!1,n=0,a=t.length;a>n;n++){for(var s=null,o=0,h=t[n].length;h>o;o++){if(z(t[n][o],e,l)){s=t[n][o],i=!0;break}s=null}r.push(s)}return i?r:!1}function z(t,e,l){return"number"==typeof t[l]?3>Math.abs(t[l]-e):!1}function N(t){var e=t.get("$floatPointer");return e||(e=[],t.set("$floatPointer",e)),e}function F(t){var l=t.get("$floatLine");return l||(l=t.get("paper").path(""),t.set("$floatLine",l),n.fixSVGLineStyle(l,e.svg)),l}function R(t,e){var l=e.context,r=l.getBBox();return t.x>=r.left&&t.x<=r.left+r.width&&t.y>=r.top&&t.y<=r.top+r.height}function D(){var t=this.get("$tip");t&&t.hide()}function $(t){var e=E(t),l=e.offsetX,r=e.offsetY;if(R({x:l,y:r},{context:this})){j&&clearTimeout(j);var i,a=this.get("seriesPoints"),s=P(a,l,"x"),o=this.get("paper"),h=this,c=this.get("$series"),x=N(this);if(s){var y=[];G(s,function(t,e){t?(x[e]?x[e].attr({cx:t.x,cy:t.y,fill:c[e].color.DEFAULT,stroke:"#fff","stroke-width":2}):(x[e]=o.circle(t.x,t.y,5),c[e]&&c[e].color&&x[e].attr({fill:c[e].color.DEFAULT,stroke:"#fff","stroke-width":2})),y.push({index:e,xvalue:t.rawx,yvalue:t.rawy}),x[e].show()):x[e]&&x[e].hide()});var u=n.averagePoints(s);if(u){h.fire("pointover",{x:n.roundToFixed(u.x,10),y:n.roundToFixed(u.y,10),data:y}),i=F(this);var f=this.getPadding(),d=["M",u.x,f.paddingy,"L",u.x,f.paddingy+this.get("innerHeight")].join(",");i.attr({path:d}).attr(B()),i.show()}}j=setTimeout(function(){G(x,function(t){t&&t.hide()}),i=F(h),i&&i.hide()},1e3)}}function O(t){var e=t.get("$xgrid"),l=t.get("$ygrid");e&&e.toBack(),l&&l.toBack()}var Y="{COLOR}",G=t.each;t.map;var j,X,q={inititialize:function(){var t=this.get("renderTo"),e=a.get(t);this.set("container",e);var l=this.get("theme")||"ks-chart-default";this.colorManager=new o({themeCls:l}),this.updateContainer(),this.render(),this.bindEvent()},render:function(){var l=this;if(this._isRunning)return this._runningTimer&&clearTimeout(this._runningTimer),this._runningTimer=setTimeout(function(){l.render()},300),void 0;this._isRunning=!0;var r=this.get("container"),i=this.get("paper"),a=this.get("series")||[];if(0!==a.length){var s=this.get("width"),o=this.get("height"),f=this.get("innerWidth"),p=this.get("innerHeight"),g=this.getPadding(),_=g.paddingx,k=g.paddingy;i||(i=e(r,s,o),this.set("paper",i));var C=this.get("yAxis")||{},A=this.get("xAxis")||{},E=A.range;Z=E&&E.duration,a=c(a,A,C,function(t,e,l,r){return t&&"number"==typeof t.min&&t.min>l||t&&"number"==typeof t.max&&l>t.max||e&&"number"==typeof e.min&&e.min>r||e&&"number"==typeof e.max&&r>e.max?!1:"number"!=typeof l||"number"!=typeof r?[null,null]:Z&&M(l,Z)?!1:[l,r]});var P=h(a);if(P.values.length){this.removeElements();var z=this.get("$xlabels"),N=this.get("$ylabels");this.get("$jointPoints");var F,R,D,$,Y,G,j,X,q=x(P.values,{range:C.range,n:5}),V=q.range.length;this.get("fixedInterval");var H,Z;if(E)if(Z)if(F=L(Z),Z.indexOf("day")>-1)D=0,Y=F[F.length-1],j=F.length;else if(Z.indexOf("week"))D=1,Y=F[F.length-1],j=F.length;else{if(!Z.indexOf("month"))throw Error("duration is not in correct format");D=1,Y=F[F.length-1],j=F.length}else{var U=E.min,W=E.max,K=E.step||1;0!=E.isDate&&(H=!0),"number"!=typeof U&&(U=Math.min.apply(Math,P.dates)),"number"!=typeof W&&(W=Math.max.apply(Math,P.dates));var Q=u(U,W,K);F=Q.range,D=Q.min,Y=Q.max,j=Q.len}else{H=!0;var J={n:C.num};if(!P.dates.length)return;var te=y(P.dates,J),ee=te.range.length,le=te.min,re=te.max;te.unit,F=te.range,D=le,Y=re,j=ee}R=q.range,$=q.min,G=q.max,X=V;var ie=b(a,{xmin:D,xmax:Y,ymin:$,ymax:G,px:_,py:k,width:f,height:p});this.set("seriesPoints",ie),this.set("rangeData",{xmin:D,xmax:Y,ymin:$,ymax:G});var ne=this.get("$series");ne||(ne=[],this.set("$series",ne)),t.each(ie,function(t,e){var r=l.colorManager.getColor(e),n=l.get("point"),a=l.get("lineType"),s=l.get("$lines");s||(s=[],l.set("$lines",s));var o,h=S(l,e),c=l.get("series"),x=c[e];x.hided?(o={color:r,$path:null},s[e]=o.$line,o.name=x.name,ne[e]=o):(w(t,{paper:i,color:r,$line:h,lineType:a,pointConfig:n,context:l}).then(function(t){s[e]=t.$line,t.name=x.name,ne[e]=t,l.renderLegend().then(function(){l.fire("afterRender"),l._isRunning=!1}).fail(function(t){window.console&&window.console.log(t)}),O(l)}).fail(function(){}),h&&h.show())});for(var ae=[],se=[],oe=0;j>oe;oe++){var he,ce;he=oe/(j-1)*f+_,ce=o-k,0===oe?ae.push({x:he,y:ce}):oe===j-1&&ae.push({x:he,y:ce});var xe;if(H){var ye=this.get("dateformat")||"yyyy-MM-dd";xe=n.formatDate(new Date(F[oe]),ye)}else xe=Z?T(oe,Z):F[oe];var ue=this.get("xLabel");ue.hook&&t.isFunction(ue.hook)&&(xe=ue.hook.call(l,xe));var fe=i.text(he,ce,xe);ue&&ue.rotate?fe.attr({"text-anchor":"end",transform:"t-5,5r-45,"+he+","+ce}):fe.attr({transform:"t0,12"}),z.push(fe)}for(var de=0;X>de;de++){var he,ce;he=_,ce=o-k-de/(X-1)*p,0===de?se.push({x:he,y:ce}):de===X-1&&se.push({x:he,y:ce});var pe=i.text(he,ce,q.range[de]).attr({"text-anchor":"end",transform:"t-5,0"});N.push(pe)}var ge=k,ve=_+f,me=l.get("yRuller")||{},_e=_,be=k+p,we=_,ke=k,Ce=X,Se=v([_e,be],[we,ke],{n:Ce,scale:me.size||5}),Le=this.get("$rullerY");if(me.isShow!==!1){var Ae=m(Se,i,{yaxis:!0,style:me,path:Le});Le||(this.set("$rullerY",Ae),n.fixSVGLineStyle(Ae,e.svg))}var Te,Me,Ee=this.get("xGrid")||{};Ee.isShow!==!1&&(Te=I(ge,ve,Se,{paper:i,context:l}),this.set("$xgrid",Te));var Be=l.get("xRuller")||{},Ie=_,Pe=k+p,ze=_+f,Ne=k+p,Fe=j,Re=v([Ie,Pe],[ze,Ne],{n:Fe,scale:Be.size||5});if(Be.isShow!==!1){var De=this.get("$rullerX"),$e=m(Re,i,{xaxis:!0,style:Be,path:De});De||(this.set("$rullerX",$e),n.fixSVGLineStyle($e,e.svg))}var Oe=this.get("yGrid")||{};Oe.isShow!==!1&&(Me=I(ge,ve,Re,{paper:i,vertical:!0,context:l}),this.set("$ygrid",Me));var Ye,Ge;Ye=A.arrow?ae.map(function(t,e){return e?{x:t.x+15,y:t.y}:{x:t.x,y:t.y}}):ae,Ge=C.arrow?se.map(function(t,e){return e?{x:t.x,y:t.y-15}:{x:t.x,y:t.y}}):se;var je=i.path(d(Ye)).attr(B(t.merge({"stroke-width":1.5},A.style))),Xe=i.path(d(Ge)).attr(B(t.merge({"stroke-width":1.5},C.style)));A.arrow===!0&&je.attr({"arrow-end":"classic-wide-long"}),C.arrow===!0&&Xe.attr({"arrow-end":"classic-wide-long"}),this.set("$xaxis",je),this.set("$yaxis",Xe),n.fixSVGLineStyle(je,e.svg),n.fixSVGLineStyle(Xe,e.svg);var qe=this.get("tip");qe&&0!=qe&&this.renderTip()}}},updateContainer:function(){var t,e,l=this.get("container"),r=a.width(l),i=a.height(l);this.set("width",r),this.set("height",i);var n,s,o=this.getPadding();n=o.paddingx,s=o.paddingy,t=r-2*n,e=i-2*s,this.set("innerWidth",t),this.set("innerHeight",e)},bindEvent:function(){var t=this.get("container");s.on(t,"mouseleave",D,this),this.get("point"),s.on(t,"mousemove",$,this)},unbindEvent:function(){var t=this.get("container");s.detach(t,"mouseleave",D)},addData:function(t){for(var e=this.get("series"),l=0,r=t.length;r>l;l++)n.combineSeries(t[l],e)},clearData:function(){this.set("series",[])},drawLine:function(t,l){l||(l={});var r,i=t.split("="),a=i[0],s=parseFloat(i[1]),o=this.get("innerWidth"),h=this.get("innerHeight"),c=this.getPadding(),x=this.get("paper"),y={},u={};if(l.raw)"x"===a?(y.x=s,y.y=c.paddingy,u.x=y.x,u.y=h+c.paddingy):(y.x=c.paddingx,y.y=s+c.paddingy,u.x=o+c.paddingx,u.y=s+c.paddingy);else{var f=this.get("rangeData");if("x"===a){if(s>f.xmax||f.xmin>s)return!1;y.x=c.paddingx+(s-f.xmin)/(f.xmax-f.xmin)*o,y.y=c.paddingy,u.x=y.x,u.y=y.y+h}else{if(s>f.ymax||f.ymin>s)return!1;y.x=c.paddingx,y.y=(s-f.ymin)/(f.ymax-f.ymin)*h,y.y=c.paddingy+h-y.y,u.x=y.x+o,u.y=y.y}}return r=x.path(["M",y.x,y.y,"L",u.x,u.y].join(",")),n.fixSVGLineStyle(r,e.svg),r.attr(B(l.style)),{$path:r,start:y,end:u}},getBBox:function(){var t=this.getPadding(),e=this.get("innerWidth"),l=this.get("innerHeight");return{width:e,height:l,left:t.paddingx,top:t.paddingy}},getPadding:function(){var e=t.isNumber(this.get("paddingx"))?this.get("paddingx"):15,l=t.isNumber(this.get("paddingy"))?this.get("paddingx"):15;return{paddingx:e,paddingy:l}},buildLegendParts:function(){var e=[],l="";return e=t.map(this.get("$series"),function(t){return l+=t.name,{DEFAULT:t.color.DEFAULT,HOVER:t.color.HOVER,text:t.name,$path:t.$path}}),this.legendString=l,e},renderLegend:function(){var l=this,i=l.get("legend"),n=new r.Defer,a=n.promise;if(i&&0!=i.isShow){var s=this.get("$legend");s&&s.destroy&&s.destroy(),t.use("gallery/kcharts/1.3/legend/index",function(t,r){var a=l.get("paper"),s=l.get("container"),o=(l.getPadding(),l.legendString),h=l.buildLegendParts(),c=l.legendString;if(o===c)return n.resolve(),void 0;var x=this.get("legend");x&&x.destroy&&x.destroy();var y={paper:a,container:s,bbox:l.getBBox(),iconAttrHook:function(t){var e=h[t].color;return{fill:e}},spanAttrHook:function(t){var l=e.getRGB(h[t].DEFAULT);return{color:l.hex}},config:h};x=new r(t.merge(y,i)),x.on("click",function(t){var e=t.index,l=(t.text,t.icon,t.el);1!=l.hide?(this.hideLine(e),l.hide=1,l.disable()):(this.showLine(e),l.hide=0,l.enable())},l),l.set("legend",x),n.resolve()})}return a},renderTip:function(e){if(!this.get("$tip")&&(e||(e=this.get("tip")),e)){var l=this,r=l.get("container");t.use("gallery/kcharts/1.3/tip/index,gallery/kcharts/1.3/tip/assets/tip.css",function(t,i){var n=l.getBBox();n.x=n.left,n.y=n.top;var a=e.themeCls||"ks-chart-default",s=e.boundryDetect?n:{},o=t.mix(e,{rootNode:r,clsName:a,boundry:s},void 0,void 0,!0),h=new i(o);l.set("$tip",h),l.on("pointover",function(r){var i=r.x+20,n=r.y;r.index,r.xvalue,r.yvalue,t.isFunction(e.template)?h.setContent(e.template.apply(h,[r.index,r.data])):h.renderTemplate(e.template,r),h.fire("move",{x:i,y:n,style:l.processAttr(e.css,{DEFAULT:"yellow",HOVER:"blue"})})},l)})}},processAttr:function(e,l){var r=t.clone(e);for(var i in r)r[i]&&"string"==typeof r[i]&&(r[i]=r[i].replace(Y,l));return r},hideLine:function(e){if(t.isNumber(e)){var l=this.get("$series")[e],r=this.get("series")[e];if(l){var i=l.$line;i&&i.hide();var n=l.$points;n&&n.hide(),r.hided=!0}else r.hided=!0,this.render()}},showLine:function(e){if(t.isNumber(e)){var l=this.get("$series")[e],r=this.get("series")[e];if(l&&l.$line){var i=l.$line;i&&i.show();var n=l.$points;n&&n.show(),r.hided=!1}else r.hided=!1,this.render()}},removeElements:function(){var t=this.get("paper");C(this.get("$series"));var e=this.get("$xlabels");e?f(e):(e=t.set(),this.set("$xlabels",e));var l=this.get("$ylabels");l?f(l):(l=t.set(),this.set("$ylabels",l)),this.get("$xaxis")&&this.get("$xaxis").remove(),this.get("$yaxis")&&this.get("$yaxis").remove();var r=this.get("$jointPoints");r?f(r):(r=[],this.set("$jointPoints",r))},destroy:function(){this.unbindEvent(),this.removeElements()}};return l.extend?X=l.extend(q):(X=function(t){this.set(t),this.inititialize()},t.extend(X,l,q)),X},{requires:["gallery/kcharts/1.3/raphael/index","base","promise","gallery/kcharts/1.3/animate/index","./util","dom","event","gallery/kcharts/1.3/tools/color/index"]});