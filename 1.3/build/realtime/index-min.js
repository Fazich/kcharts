/*! kcharts - v1.3 - 2014-01-09 2:22:58 PM
* Copyright (c) 2014 数据可视化小组; Licensed  */
KISSY.add("gallery/kcharts/1.3/realtime/util",function(){function t(t,l){for(var e=Math.min.apply(Math,t),r=Math.max.apply(Math,t),i=r-e,n=[u,f,d,p,g],a=[],s=0;n.length>s;s++){var o=i/n[s];if(1>o)break;a.push(o-l)}var h,c=Math.min.apply(Math,a);h=c?a.indexOf(c):0;var x=["minute","hour","day","week","month"];return x[h]}function l(t){var l={minute:6e4,hour:36e5,day:864e5,week:6048e5,month:18144e6};return l[t]}function e(t,l){var e={"M+":t.getMonth()+1,"d+":t.getDate(),"h+":t.getHours(),"m+":t.getMinutes(),"s+":t.getSeconds(),"q+":Math.floor((t.getMonth()+3)/3),S:t.getMilliseconds()};/(y+)/.test(l)&&(l=l.replace(RegExp.$1,(t.getFullYear()+"").substr(4-RegExp.$1.length)));for(var r in e)RegExp("("+r+")").test(l)&&(l=l.replace(RegExp.$1,1==RegExp.$1.length?e[r]:("00"+e[r]).substr((""+e[r]).length)));return l}function r(t,l){return Math.round(t*l)/l}function i(t,l,e){e>1?e=1:0>e&&(e=0);var r=t+(l-t)*e;return Math.round(100*r)/100}function n(t,l){var e=[l[0]-t[0],l[1]-t[1]];if(0===e[0])return e[1]>0?90:0>e[1]?-90:0;var r=B*Math.atan(e[1]/e[0]);return 0>e[0]&&(r-=180),r}function a(t,l,e){e||(e={});var a,s,o,h,c="number"!=typeof e.scale?3:e.scale,x="number"!=typeof e.ratio?.5:e.ratio,y=1e6,u=n(t,l),f=Math.cos(u*M),d=Math.sin(u*M),p=i(t[0],l[0],x),g=i(t[1],l[1],x);return a=p+d*c,o=g-f*c,s=p-d*c,h=g+f*c,{x0:r(p,y),y0:r(g,y),x1:r(a,y),y1:r(o,y),x2:r(s,y),y2:r(h,y)}}function s(t,l){for(var e=t.name,r=!0,i=0,n=l.length;n>i;i++)if(l[i].name===e){var a=l[i].data;l[i].data=[].concat(a,t.data),r=!1;break}r&&l.push(t)}function o(t,l){var e=l&&t&&t[0];e&&e.setAttribute("shape-rendering","crispEdges")}function h(t){var l,e,r,i;r=i=0;for(var n=0,a=0,s=t.length;s>a;a++)t[a]&&"number"==typeof t[a].x&&(r+=t[a].x,i+=t[a].y,n++);return l=r/n,e=i/n,{x:l,y:e}}function c(t,l,e){return l.length>=t?l:c(t,e+l,e)}var x={},y=function(t){this.console&&console.log(t)},u=6e4,f=36e5,d=864e5,p=6048e5,g=18144e6;x.chooseUnit=t,x.unit2digts=l;var v=2.220446049250313e-16,m=1/Math.log(10),b=function(t,l,e,r,i,n){var a;return a=(v>r%n||v>n-r%n)&&0>=r&&i>=0?1:0,1-t/(l-1)-e+a},_=function(t,l,e){return 1-t/(l-1)-e+1},w=function(t,l,e,r){var i;return i=l-t,1-.5*(Math.pow(l-r,2)+Math.pow(t-e,2))/Math.pow(.1*i,2)},k=function(t,l,e){var r,i;return i=l-t,e>i?(r=(e-i)/2,1-.5*(Math.pow(r,2)+Math.pow(r,2))/Math.pow(.1*i,2)):1},C=function(t,l,e,r,i,n){var a,s;return a=(t-1)/(n-i),s=(l-1)/(Math.max(n,r)-Math.min(e,i)),2-Math.max(a/s,s/a)},S=function(t,l){return t>=l?2-(t-1)/(l-1):1},A=function(t,l,e,r,i,n){var a,s,o,h,c,x,y,u,f,d,p,g,A,T,L,M,B,E,z,I,P,N,R,F,D,$,O,Y,j,G,X,q,V;if(null==r&&(r=!1),null==i&&(i=[1,5,2,2.5,4,3]),null==n&&(n={simplicity:.2,coverage:.25,density:.5,legibility:.05}),F=function(t,l,e,r){return n.simplicity*t+n.coverage*l+n.density*e+n.legibility*r},s=0,a=0,o=0,h=-2,f=v,q=t>l?[l,t]:[t,l],z=q[0],B=q[1],f>l-t)return[z,B,e,-2];for(T=i.length,p=-1;Number.POSITIVE_INFINITY>p;){for(N=G=0,V=T-1;V>=0?V>=G:G>=V;N=V>=0?++G:--G)if(P=i[N],D=_(N,T,p),h>F(D,1,1,1))p=Number.POSITIVE_INFINITY;else for(g=2;Number.POSITIVE_INFINITY>g;){if(u=S(g,e),h>F(D,1,u,1))g=Number.POSITIVE_INFINITY;else for(y=(B-z)/(g+1)/p/P,j=Math.ceil(Math.log(y)*m);Number.POSITIVE_INFINITY>j;)if(O=p*P*Math.pow(10,j),x=k(z,B,O*(g-1)),h>F(D,x,u,1))j=Number.POSITIVE_INFINITY;else{if(I=Math.floor(B/O)*p-(g-1)*p,E=Math.ceil(z/O)*p,I>E);else for($=X=I;E>=I?E>=X:X>=E;$=E>=I?++X:--X)M=$*(O/p),L=M+O*(g-1),(!r||z>=M&&L>=B)&&(R=b(N,T,p,M,L,O),c=w(z,B,M,L),d=C(g,e,z,B,M,L),A=1,Y=F(R,c,d,A),Y>h&&(h=Y,s=M,a=L,o=O));j+=1}g+=1}p+=1}return[s,a,o,h]};x.getProperUnit=A;var T=function(t,l,e){var r=A(t,l,e),i=r[0],n=r[1],a=r[2];l>n&&(n+=a),i>t&&(i-=a);for(var s=(n-i)/a,o=[],h=i,c=1;s>=c;c++)o.push(h),h+=a;return o.push(h),o};x.axis=T;var L=function(e,r){var i=Math.max.apply(Math,e),n=t(e,r);n||y("ERR OCCURED!");var a,s,o=l(n),h=e.map(function(t){return t/o});a=Math.min.apply(Math,h),s=Math.max.apply(Math,h);var c=T(a,s,r),x=Math.min.apply(Math,c)*o,u=Math.max.apply(Math,c)*o;return i>u&&(u+=o),c=c.map(function(t){return+new Date(t*o)}),{dates:c,unit:o,min:x,max:u}};x.getlabel=L,x.formatDate=e,x.roundToFixed=r;var M=Math.PI/180,B=180/Math.PI;return x.verticalLine=a,x.combineSeries=s,x.fixSVGLineStyle=o,x.averagePoints=h,x.pad=c,x}),KISSY.add("gallery/kcharts/1.3/realtime/index",function(t,l,e,r,i,n,a,s,o){function h(t){for(var l=[],e=[],r=0;t.length>r;r++){var i=t[r],n=i.data;if(n)for(var a=0;n.length>a;a++){var s=n[a];"number"==typeof s[0]?l.push(s[0]):l.push(null),"number"==typeof s[1]?e.push(s[1]):e.push(null)}}return{dates:l,values:e}}function c(t,l,e,r){for(var i=[],n=l.range,a=e.range,s=0,o=t.length;o>s;s++){var h;if(t[s].hided)h=[];else{var c=t[s];h={data:[],name:c.name};for(var x=0,y=c.data.length;y>x;x++){var u=c.data[x],f=u[0],d=u[1],p=r(n,a,f,d);p&&h.data.push(p)}}i.push(h)}return i}function x(t,l){l||(l={}),l.n||(l.n=5);var e=Math.min.apply(Math,t),r=Math.max.apply(Math,t);l.range&&"number"==typeof l.range.min&&e>l.range.min&&(e=l.range.min),l.range&&"number"==typeof l.range.max&&l.range.max>r&&(r=l.range.max);var i=n.axis(e,r,l.n),a=Math.min.apply(Math,i),s=Math.max.apply(Math,i),o={min:a,max:s,range:i};return o}function y(t,l){l||(l={n:5});var e=n.getlabel(t,l.n),r=e.min,i=e.max,a={unit:e.unit,min:r,max:i,range:e.dates};return a}function u(t,l,e){var r=t,i=Math.floor((l-t)/e);r=t+i*e;for(var n=[],a=t;r>=a;a+=e)n.push(a);return{range:n,min:t,max:r,len:i}}function f(t){for(;t.length;){var l=t.pop();l&&l.remove&&l.remove()}}function d(t){for(var l,e=0,r=t.length;r>e;e++){var i=t[e],n=i.x,a=i.y;e?l.push("L",n,a):l=["M",n,a]}return l.join(",")}function p(t){var l,e,r,i,a=[];if(2>=t.length)for(var s=0,o=t.length;o>s;s++)e=t[s],r=e.x,i=e.y,r=n.roundToFixed(r,100),i=n.roundToFixed(i,100),s?a.push("L",r,i):a.push("M",r,i);else for(var s=0,o=t.length;o>s;s++)e=t[s],r=e.x,i=e.y,r=n.roundToFixed(r,100),i=n.roundToFixed(i,100),s?a.push(r,i):a.push("M",r,i,"R");return l=a.join(",")}function g(t,l){for(var e,r,i,n=[],a=[],s=0,o=t.length;o>s;s++)e=t[s],r=e.x,i=e.y,null===r?(n.push(a),a=[]):a.push(e);n.push(a);for(var h="",c=0,x=n.length;x>c;c++)h+=l(n[c]);return h}function v(t,l,e){for(var r,i,a=[],s=0,o=e.n;o>s;s++)r=s/(o-1),e.ratio=r,i=n.verticalLine(t,l,e),a.push(i);return a}function m(t,l,e){if(e||(e={}),2>arguments.length)return!1;for(var r,i,a,s,o,h=e.style||{},c=h.ruller||"-.",x=[],y=1,u=t.length;u>y;y++){if(r=t[y],"-."===c)i=r.x0,s=r.y0,e.xaxis?(a=r.x2,o=r.y2):(a=r.x1,o=r.y1);else if(".-"===c)e.xaxis?(i=r.x0,s=r.y0,a=r.x2,o=r.y2):(i=r.x0,s=r.y0,a=r.x1,o=r.y1);else{if("-.-"!==c)return!1;i=r.x1,s=r.y1,a=r.x2,o=r.y2}x.push("M",n.roundToFixed(i,10),n.roundToFixed(s,10),"L",n.roundToFixed(a,10),n.roundToFixed(o,10))}var f=x.join(","),d=e.path;if(d)d.animate({path:f},200);else{var p=E(h.style);d=l.path(f).attr(p)}return d}function b(t,l){var e,r,i=l.xmin,n=l.xmax,a=l.ymin,s=l.ymax,o=l.px,h=l.py,c=t[0],x=t[1],y=l.width,u=l.height;return null===c||null===x?(e=null,r=null):(e=(c-i)/(n-i)*y+o,r=u-(x-a)/(s-a)*u+h),[e,r]}function _(t,l){for(var e=[],r=0;t.length>r;r++){var i=[];e.push(i);var n=t[r],a=n.data;if(a)for(var s=0;a.length>s;s++){var o,h,c=a[s],x=b(c,l);o=x[0],h=x[1],i.push({x:o,y:h,rawx:c[0],rawy:c[1]})}}return e}function w(t,e){function n(){o.attr({stroke:c.DEFAULT,"stroke-width":2}),o.hover(function(){o.attr({stroke:c.HOVER,"stroke-width":3})},function(){o.attr({stroke:c.DEFAULT,"stroke-width":2})})}var a=new r.Defer,s=a.promise;e.context;var o,h,c,x=e.paper;h=x.set(),c=e.color;var y,u;if(u="arc"===e.lineType?g(t,p):g(t,d),e.$line)o=e.$line,o.animate({path:u},200),setTimeout(function(){a.resolve({$line:o,$points:h,color:c})},0);else{var f,v=l.getTotalLength(u);y=i.AnimateObject([{from:{per:0},to:{per:1},frame:function(t,e){var r=l.getSubpath(u,0,e*v);o?o.attr({path:r}):(o=x.path(r),n()),f=e},endframe:function(){1!==f&&o.attr({path:u}),a.resolve({$line:o,$points:h,color:c})}}],{easing:"easeNone",duration:1e3})}return e.pointConfig.isShow!==!1&&j(t,function(t){var l=x.circle(t.x,t.y,4);l.attr({stroke:"#fff",fill:c.DEFAULT,"stroke-width":2}),h.push(l)}),s}function k(t){var l=(t.$line,t.$points);l&&l.unhover(),l&&l.remove()}function C(t){if(t)for(var l=0,e=t.length;e>l;l++)k(t[l])}function S(t,l){var e=t.get("$lines");return e&&e[l]}function A(t){var l=/(\d+)?(day|week|month)/,e=t.match(l);if(!e)return!1;var r,i;r=e.length>1?parseInt(e[1])||1:1,i=e[2];var n,a=[];if("day"===i)a.push(0),n=24*r-1;else if("week"===i)n=7*r;else if("month"===i){var s=new Date;n=new Date(s.getFullYear(),s.getMonth()+1,0).getDate(),n*=r}for(var o=1;n>=o;o++)a.push(o);return a}function T(t){return 10>t?"0"+t:t}function L(t,l){if("day"===l)return T(t)+":00";if("week"===l){var e=["一","二","三","四","五","六","日"];return"星期"+e[t-1]}return"month"===l?n.formatDate(new Date,"yyyy-MM")+"-"+T(t,2):!1}function M(t,l){var e=A(l),r=e[0],i=e[e.length-1];return t>=r&&i>=t?!1:!0}function B(t){var l=t.currentTarget;if(t.offsetX)return{offsetX:t.offsetX,offsetY:t.offsetY};var e=a.offset(l);return{offsetX:t.offsetX||t.clientX-e.left,offsetY:t.offsetY||t.clientY-e.top}}function E(l){return t.merge({stroke:"#999","stroke-width":"1"},l)}function z(t,e,r,i){for(var a,s,o,h,c,x=i.paper,y=i.context,u=[],f=1,d=r.length;d>f;f++)i.vertical?(a=r[f].x0,s=r[f].y0,o=a,h=t,c="$yGrid"):(a=r[f].x0,s=r[f].y0,o=e,h=s,c="$xGrid"),u.push("M",a,s,"L",o,h);var p=y.get(c);return p?p.attr({path:u.join(",")}):(p=x.path(u.join(",")),y.set(c,p),p.attr(E()),n.fixSVGLineStyle(p,l.svg)),p}function I(t,l,e){e||(e="x");for(var r=[],i=!1,n=0,a=t.length;a>n;n++){for(var s=null,o=0,h=t[n].length;h>o;o++){if(P(t[n][o],l,e)){s=t[n][o],i=!0;break}s=null}r.push(s)}return i?r:!1}function P(t,l,e){return"number"==typeof t[e]?3>Math.abs(t[e]-l):!1}function N(t){var l=t.get("$floatPointer");return l||(l=[],t.set("$floatPointer",l)),l}function R(t){var e=t.get("$floatLine");return e||(e=t.get("paper").path(""),t.set("$floatLine",e),n.fixSVGLineStyle(e,l.svg)),e}function F(t,l){var e=l.context,r=e.getBBox();return t.x>=r.left&&t.x<=r.left+r.width&&t.y>=r.top&&t.y<=r.top+r.height}function D(){var t=this.get("$tip");t&&t.hide()}function $(t){var l=B(t),e=l.offsetX,r=l.offsetY;if(F({x:e,y:r},{context:this})){G&&clearTimeout(G);var i,a=this.get("seriesPoints"),s=I(a,e,"x"),o=this.get("paper"),h=this,c=this.get("$series"),x=N(this);if(s){var y=[];j(s,function(t,l){t?(x[l]?x[l].attr({cx:t.x,cy:t.y,fill:c[l].color.DEFAULT,stroke:"#fff","stroke-width":2}):(x[l]=o.circle(t.x,t.y,5),c[l]&&c[l].color&&x[l].attr({fill:c[l].color.DEFAULT,stroke:"#fff","stroke-width":2})),y.push({index:l,xvalue:t.rawx,yvalue:t.rawy}),x[l].show()):x[l]&&x[l].hide()});var u=n.averagePoints(s);if(u){h.fire("pointover",{x:n.roundToFixed(u.x,10),y:n.roundToFixed(u.y,10),data:y}),i=R(this);var f=this.getPadding(),d=["M",u.x,f.paddingy,"L",u.x,f.paddingy+this.get("innerHeight")].join(",");i.attr({path:d}).attr(E()),i.show()}}G=setTimeout(function(){j(x,function(t){t&&t.hide()}),i=R(h),i&&i.hide()},1e3)}}function O(t){var l=t.get("$xgrid"),e=t.get("$ygrid");l&&l.toBack(),e&&e.toBack()}var Y="{COLOR}",j=t.each;t.map;var G,X,q={inititialize:function(){var t=this.get("renderTo"),l=a.get(t);this.set("container",l);var e=this.get("theme")||"ks-chart-default";this.colorManager=new o({themeCls:e}),this.updateContainer(),this.render(),this.bindEvent()},render:function(){var e=this;if(this._isRunning)return this._runningTimer&&clearTimeout(this._runningTimer),this._runningTimer=setTimeout(function(){e.render()},300),void 0;this._isRunning=!0;var r=this.get("container"),i=this.get("paper"),a=this.get("series")||[];if(0!==a.length){var s=this.get("width"),o=this.get("height"),f=this.get("innerWidth"),p=this.get("innerHeight"),g=this.getPadding(),b=g.paddingx,k=g.paddingy;i||(i=l(r,s,o),this.set("paper",i));var C=this.get("yAxis")||{},T=this.get("xAxis")||{},B=T.range;H=B&&B.duration,a=c(a,T,C,function(t,l,e,r){return t&&"number"==typeof t.min&&t.min>e||t&&"number"==typeof t.max&&e>t.max||l&&"number"==typeof l.min&&l.min>r||l&&"number"==typeof l.max&&r>l.max?!1:"number"!=typeof e||"number"!=typeof r?[null,null]:H&&M(e,H)?!1:[e,r]});var I=h(a);if(I.values.length){this.removeElements();var P=this.get("$xlabels"),N=this.get("$ylabels");this.get("$jointPoints");var R,F,D,$,Y,j,G,X,q=x(I.values,{range:C.range,n:5}),V=q.range.length;this.get("fixedInterval");var Z,H;if(B)if(H)if(R=A(H),H.indexOf("day")>-1)D=0,Y=R[R.length-1],G=R.length;else if(H.indexOf("week"))D=1,Y=R[R.length-1],G=R.length;else{if(!H.indexOf("month"))throw Error("duration is not in correct format");D=1,Y=R[R.length-1],G=R.length}else{var U=B.min,W=B.max,K=B.step||1;0!=B.isDate&&(Z=!0),"number"!=typeof U&&(U=Math.min.apply(Math,I.dates)),"number"!=typeof W&&(W=Math.max.apply(Math,I.dates));var Q=u(U,W,K);R=Q.range,D=Q.min,Y=Q.max,G=Q.len}else{Z=!0;var J={n:C.num};if(!I.dates.length)return;var tl=y(I.dates,J),ll=tl.range.length,el=tl.min,rl=tl.max;tl.unit,R=tl.range,D=el,Y=rl,G=ll}F=q.range,$=q.min,j=q.max,X=V;var il=_(a,{xmin:D,xmax:Y,ymin:$,ymax:j,px:b,py:k,width:f,height:p});this.set("seriesPoints",il),this.set("rangeData",{xmin:D,xmax:Y,ymin:$,ymax:j});var nl=this.get("$series");nl||(nl=[],this.set("$series",nl)),t.each(il,function(t,l){var r=e.colorManager.getColor(l),n=e.get("point"),a=e.get("lineType"),s=e.get("$lines");s||(s=[],e.set("$lines",s));var o,h=S(e,l),c=e.get("series"),x=c[l];x.hided?(o={color:r,$path:null},s[l]=o.$line,o.name=x.name,nl[l]=o):(w(t,{paper:i,color:r,$line:h,lineType:a,pointConfig:n,context:e}).then(function(t){s[l]=t.$line,t.name=x.name,nl[l]=t,e.renderLegend().then(function(){e.fire("afterRender"),e._isRunning=!1}).fail(function(t){window.console&&window.console.log(t)}),O(e)}).fail(function(){}),h&&h.show())});for(var al=[],sl=[],ol=0;G>ol;ol++){var hl,cl;hl=ol/(G-1)*f+b,cl=o-k,0===ol?al.push({x:hl,y:cl}):ol===G-1&&al.push({x:hl,y:cl});var xl;if(Z){var yl=this.get("dateformat")||"yyyy-MM-dd";xl=n.formatDate(new Date(R[ol]),yl)}else xl=H?L(ol,H):R[ol];var ul=this.get("xLabel");ul.hook&&t.isFunction(ul.hook)&&(xl=ul.hook.call(e,xl));var fl=i.text(hl,cl,xl);ul&&ul.rotate?fl.attr({"text-anchor":"end",transform:"t-5,5r-45,"+hl+","+cl}):fl.attr({transform:"t0,12"}),P.push(fl)}for(var dl=0;X>dl;dl++){var hl,cl;hl=b,cl=o-k-dl/(X-1)*p,0===dl?sl.push({x:hl,y:cl}):dl===X-1&&sl.push({x:hl,y:cl});var pl=i.text(hl,cl,q.range[dl]).attr({"text-anchor":"end",transform:"t-5,0"});N.push(pl)}var gl=k,vl=b+f,ml=e.get("yRuller")||{},bl=b,_l=k+p,wl=b,kl=k,Cl=X,Sl=v([bl,_l],[wl,kl],{n:Cl,scale:ml.size||5}),Al=this.get("$rullerY");if(ml.isShow!==!1){var Tl=m(Sl,i,{yaxis:!0,style:ml,path:Al});Al||(this.set("$rullerY",Tl),n.fixSVGLineStyle(Tl,l.svg))}var Ll,Ml,Bl=this.get("xGrid")||{};Bl.isShow!==!1&&(Ll=z(gl,vl,Sl,{paper:i,context:e}),this.set("$xgrid",Ll));var El=e.get("xRuller")||{},zl=b,Il=k+p,Pl=b+f,Nl=k+p,Rl=G,Fl=v([zl,Il],[Pl,Nl],{n:Rl,scale:El.size||5});if(El.isShow!==!1){var Dl=this.get("$rullerX"),$l=m(Fl,i,{xaxis:!0,style:El,path:Dl});Dl||(this.set("$rullerX",$l),n.fixSVGLineStyle($l,l.svg))}var Ol=this.get("yGrid")||{};Ol.isShow!==!1&&(Ml=z(gl,vl,Fl,{paper:i,vertical:!0,context:e}),this.set("$ygrid",Ml));var Yl,jl;Yl=T.arrow?al.map(function(t,l){return l?{x:t.x+15,y:t.y}:{x:t.x,y:t.y}}):al,jl=C.arrow?sl.map(function(t,l){return l?{x:t.x,y:t.y-15}:{x:t.x,y:t.y}}):sl;var Gl=i.path(d(Yl)).attr(E(t.merge({"stroke-width":1.5},T.style))),Xl=i.path(d(jl)).attr(E(t.merge({"stroke-width":1.5},C.style)));T.arrow===!0&&Gl.attr({"arrow-end":"classic-wide-long"}),C.arrow===!0&&Xl.attr({"arrow-end":"classic-wide-long"}),this.set("$xaxis",Gl),this.set("$yaxis",Xl),n.fixSVGLineStyle(Gl,l.svg),n.fixSVGLineStyle(Xl,l.svg);var ql=this.get("tip");ql&&0!=ql&&this.renderTip()}}},updateContainer:function(){var t,l,e=this.get("container"),r=a.width(e),i=a.height(e);this.set("width",r),this.set("height",i);var n,s,o=this.getPadding();n=o.paddingx,s=o.paddingy,t=r-2*n,l=i-2*s,this.set("innerWidth",t),this.set("innerHeight",l)},bindEvent:function(){var t=this.get("container");s.on(t,"mouseleave",D,this),this.get("point"),s.on(t,"mousemove",$,this)},unbindEvent:function(){var t=this.get("container");s.detach(t,"mouseleave",D)},addData:function(t){for(var l=this.get("series"),e=0,r=t.length;r>e;e++)n.combineSeries(t[e],l)},clearData:function(){this.set("series",[])},drawLine:function(t,e){e||(e={});var r,i=t.split("="),a=i[0],s=parseFloat(i[1]),o=this.get("innerWidth"),h=this.get("innerHeight"),c=this.getPadding(),x=this.get("paper"),y={},u={};if(e.raw)"x"===a?(y.x=s,y.y=c.paddingy,u.x=y.x,u.y=h+c.paddingy):(y.x=c.paddingx,y.y=s+c.paddingy,u.x=o+c.paddingx,u.y=s+c.paddingy);else{var f=this.get("rangeData");if("x"===a){if(s>f.xmax||f.xmin>s)return!1;y.x=c.paddingx+(s-f.xmin)/(f.xmax-f.xmin)*o,y.y=c.paddingy,u.x=y.x,u.y=y.y+h}else{if(s>f.ymax||f.ymin>s)return!1;y.x=c.paddingx,y.y=(s-f.ymin)/(f.ymax-f.ymin)*h,y.y=c.paddingy+h-y.y,u.x=y.x+o,u.y=y.y}}return r=x.path(["M",y.x,y.y,"L",u.x,u.y].join(",")),n.fixSVGLineStyle(r,l.svg),r.attr(E(e.style)),{$path:r,start:y,end:u}},getBBox:function(){var t=this.getPadding(),l=this.get("innerWidth"),e=this.get("innerHeight");return{width:l,height:e,left:t.paddingx,top:t.paddingy}},getPadding:function(){var l=t.isNumber(this.get("paddingx"))?this.get("paddingx"):15,e=t.isNumber(this.get("paddingy"))?this.get("paddingx"):15;return{paddingx:l,paddingy:e}},buildLegendParts:function(){var l=[],e="";return l=t.map(this.get("$series"),function(t){return e+=t.name,{DEFAULT:t.color.DEFAULT,HOVER:t.color.HOVER,text:t.name,$path:t.$path}}),this.legendString=e,l},renderLegend:function(){var e=this,i=e.get("legend"),n=new r.Defer,a=n.promise;if(i&&0!=i.isShow){var s=this.get("$legend");s&&s.destroy&&s.destroy(),t.use("gallery/kcharts/1.3/legend/index",function(t,r){var a=e.get("paper"),s=e.get("container"),o=(e.getPadding(),e.legendString),h=e.buildLegendParts(),c=e.legendString;if(o===c)return n.resolve(),void 0;var x=this.get("legend");x&&x.destroy&&x.destroy();var y={paper:a,container:s,bbox:e.getBBox(),iconAttrHook:function(t){var l=h[t].color;return{fill:l}},spanAttrHook:function(t){var e=l.getRGB(h[t].DEFAULT);return{color:e.hex}},config:h};x=new r(t.merge(y,i)),x.on("click",function(t){var l=t.index,e=(t.text,t.icon,t.el);1!=e.hide?(this.hideLine(l),e.hide=1,e.disable()):(this.showLine(l),e.hide=0,e.enable())},e),e.set("legend",x),n.resolve()})}return a},renderTip:function(l){if(!this.get("$tip")&&(l||(l=this.get("tip")),l)){var e=this,r=e.get("container");t.use("gallery/kcharts/1.3/tip/index,gallery/kcharts/1.3/tip/assets/tip.css",function(t,i){var n=e.getBBox();n.x=n.left,n.y=n.top;var a=l.themeCls||"ks-chart-default",s=l.boundryDetect?n:{},o=t.mix(l,{rootNode:r,clsName:a,boundry:s},void 0,void 0,!0),h=new i(o);e.set("$tip",h),e.on("pointover",function(r){var i=r.x+20,n=r.y;r.index,r.xvalue,r.yvalue,t.isFunction(l.template)?h.setContent(l.template.apply(h,[r.index,r.data])):h.renderTemplate(l.template,r),h.fire("move",{x:i,y:n,style:e.processAttr(l.css,{DEFAULT:"yellow",HOVER:"blue"})})},e)})}},processAttr:function(l,e){var r=t.clone(l);for(var i in r)r[i]&&"string"==typeof r[i]&&(r[i]=r[i].replace(Y,e));return r},hideLine:function(l){if(t.isNumber(l)){var e=this.get("$series")[l],r=this.get("series")[l];if(e){var i=e.$line;i&&i.hide();var n=e.$points;n&&n.hide(),r.hided=!0}else r.hided=!0,this.render()}},showLine:function(l){if(t.isNumber(l)){var e=this.get("$series")[l],r=this.get("series")[l];if(e&&e.$line){var i=e.$line;i&&i.show();var n=e.$points;n&&n.show(),r.hided=!1}else r.hided=!1,this.render()}},removeElements:function(){var t=this.get("paper");C(this.get("$series"));var l=this.get("$xlabels");l?f(l):(l=t.set(),this.set("$xlabels",l));var e=this.get("$ylabels");e?f(e):(e=t.set(),this.set("$ylabels",e)),this.get("$xaxis")&&this.get("$xaxis").remove(),this.get("$yaxis")&&this.get("$yaxis").remove();var r=this.get("$jointPoints");r?f(r):(r=[],this.set("$jointPoints",r))},destroy:function(){this.unbindEvent(),this.removeElements()}};return e.extend?X=e.extend(q):(X=function(t){this.set(t),this.inititialize()},t.extend(X,e,q)),X},{requires:["gallery/kcharts/1.3/raphael/index","base","promise","gallery/kcharts/1.3/animate/index","./util","dom","event","gallery/kcharts/1.3/tools/color/index"]});