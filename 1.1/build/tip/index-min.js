KISSY.add("gallery/kcharts/1.1/tip/index",function(h,p,q,m){function n(a){if(a){var c={clsName:"ks-chart-default",autoRender:!0,isVisable:!1,boundry:{x:0,y:0,width:0,height:0},rootNode:g("body"),tpl:"",corner:{isShow:!1,tpl:"corner",css:{position:"absolute",marginLeft:0,marginTop:0}},anim:{easing:"easeOut",duration:0.25},offset:{x:0,y:0},alignX:"left",alignY:"top"};this._events={MOVE:"move",SETCONT:"setcontent",HIDE:"hide"};this._cfg=h.mix(c,a,m,m,!0);this._cfg.rootNode=g(this._cfg.rootNode);this.init()}}
var g=h.all;h.augment(n,p,{init:function(){var a=this._cfg;this._data={};this._tpl=a.tpl;this.$tip;this.bindEvent();a.autoRender&&this.render()},bindEvent:function(){var a=this,c=a._cfg.template,d=a._events;a.on(d.MOVE,function(b){var c=b.x,d=b.y;b=b.style;a.isVisable()?a.animateTo(c,d):a.moveTo(c,d);b&&a.$tip.css(b)});a.on(d.SETCONT,function(b){h.isFunction(c)?a.setContent(c(b.data)):a.renderTemplate(c,b.data)});a.on(d.HIDE,function(b){a.hide()})},getInstance:function(){return this.$tip},isVisable:function(){return"none"==
this.$tip.css("display")?!1:!0},show:function(){this.$tip&&this.$tip.show();return this},hide:function(){this.$tip&&this.$tip.stop()&&this.$tip.hide();return this},moveTo:function(a,c){this.show();var d=this.getInstance(),b=this._cfg,e=this.getPos(a,c),b=b.corner.css["margin-left"]||b.corner.css.marginLeft||0,f=this.$corner;f&&f.css({"margin-left":b+a-e.x});d.css({"margin-top":e.y,"margin-left":e.x})},animateTo:function(a,c,d){this.show();var b=this.getInstance(),e=this._cfg,f=e.anim;c=this.getPos(a,
c);var e=e.corner.css["margin-left"]||e.corner.css.marginLeft||0,k=this.$corner;k&&k.css({"margin-left":e+a-c.x});b.stop().animate({"margin-top":c.y,"margin-left":c.x},f.duration,f.easing,function(){d&&d()})},renderTemplate:function(a,c){return this.setContent(q(a).render(c))},setContent:function(a){return g("."+this._cfg.clsName+"-tip-content",this.$tip).html(a)},getPos:function(a,c){var d=this._cfg,b=d.offset,e=c+b.y,f=a+b.x,k=d.alignX,g=d.alignY,l=this.getInstance(),h=l.outerWidth(),l=l.outerHeight(),
d=d.boundry;this.set("x",a||0);this.set("y",c||0);switch(k){case "center":f=Math.round(a)+b.x-h/2;break;case "right":f=Math.round(a)+b.x-h}switch(g){case "middle":e=Math.round(c)+b.y-l/2;break;case "bottom":e=Math.round(c)+b.y-l}if(d.width&&d.height){var k=d.x||0,g=d.y||0,m=d.width,d=d.height;e<g?e=c- -Math.abs(b.y):e>g+d-l&&(e=c-l-Math.abs(b.y));f<k?f=a- -Math.abs(b.x):f>k+m-h&&(f=a-h-Math.abs(b.x))}return{x:f,y:e}},_isExist:function(){return this.$tip&&this.$tip[0]},render:function(){var a=this._cfg,
c=this._tpl,d=this._data,b=a.isVisable?"inline-block":"none",e=a.rootNode.offset();if(a.rootNode.offset())return this.$tip=!this._isExist()&&g('<span class="'+a.clsName+'-tip" style="*zoom:1;"><span class="'+a.clsName+'-tip-content"></span></span>').css({display:b}).appendTo(a.rootNode),this.$corner=a.corner.isShow&&a.corner.tpl?g("<div class='"+a.clsName+"-corner'>"+a.corner.tpl+"</div>").css(a.corner.css).appendTo(this.$tip):m,this.$tip.css({"margin-top":e.top+a.offset.y,"margin-left":e.left+a.offset.x,
position:"absolute"}),this.renderTemplate(c,d),this.$tip}});return n},{requires:["base","gallery/template/1.0/index","./assets/tip.css"]});
